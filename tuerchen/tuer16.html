<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Adventskalender - Dataframes in R</title>
        <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                background: url('background.jpeg');
                background-size: cover;
                background-position: center center;
                background-repeat: no-repeat;
                background-attachment: fixed;
                font-family: 'Quicksand', sans-serif;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                padding: 20px;
                color: #ffffff;
                overflow-x: hidden;
            }

            .snow {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                pointer-events: none;
                z-index: 1;
            }

            .snowflake {
                position: absolute;
                background: white;
                border-radius: 50%;
                opacity: 0.8;
                animation: fall linear infinite;
            }

            @keyframes fall {
                to {
                    transform: translateY(100vh) rotate(720deg);
                }
            }

            .content {
                position: relative;
                z-index: 2;
                text-align: center;
                max-width: 800px;
                padding: 20px;
                background: rgba(0, 0, 0, 0.656);
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            }

            h1 {
                color: #E0E7FF;
                font-size: 2em;
                font-weight: 700;
                text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
                margin-bottom: 20px;
            }

            p {
                color: #c9ddf7;
                font-size: 1.2em;
                font-weight: 400;
                margin-bottom: 10px;
                text-align: left;
            }

            ul {
                color: #c9ddf7;
                font-size: 1em;
                font-weight: 400;
                margin-left: 40px;
                margin-bottom: 20px;
                text-align: left;
            }

            li {
                margin-bottom: 10px;
            }

            .navigation {
                display: flex;
                gap: 20px;
                justify-content: center;
                margin-top: 20px;
            }

            .nav-button {
                padding: 10px 20px;
                font-size: 1.2em;
                color: #E0E7FF;
                text-decoration: none;
                background: rgba(255, 255, 255, 0.2);
                border: none;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
            }

            .nav-button:hover {
                background: rgba(255, 255, 255, 0.5);
                transform: scale(1.05);
            }

            .nav-button:disabled {
                opacity: 0.5;
                cursor: not-allowed;
                transform: none;
            }

            .page {
                display: none;
            }

            .page.active {
                display: block;
            }

            pre {
                background-color: #d8d8d814;
                border: 1px solid #ddd;
                border-radius: 4px;
                padding: 10px;
                font-family: 'Courier New', monospace;
                white-space: pre-wrap;
                word-wrap: break-word;
                text-align: left;
                margin: 10px 0;
                font-size: 0.8em;
                line-height: 1.4;
            }
        </style>
    </head>
    <body>
        <div class="snow" id="snowContainer"></div>
        <div class="content">
            <div class="page active" data-page="1">
                <h1>Türchen 15: Kimura-Distanz</h1>
            <p>Heyy, heute schauen wir uns das Kimura 2-Parameter Model an oder kürzer die Kimura Distanz. Dieses Model beachtet 2 Typen von Mutationen einmal Transitions (P) und Transversions (Q). Die Formel ist d = -(1/2) ln[(1-2P-Q)*sqrt(1-2Q)]. Wir wollen jetzt eine Funktion schreiben die P und Q berechnet und so die Distanz von 2 Sequenzen bestimmen kann. Als Gerüst starten wir mit:</p>
            <pre>
kimura_distance = function(seq1, seq2) {
  # code kommt hier rein
}             
            </pre>
            <p>Wir wollen das ganze mit Logischen Vektoren lösen, dafür schauen wir uns zuerst die Transitions an, alsooo hat sich in der seq1 ein "A" zu "G" oder ein "G" zu "A" oder ein "C" zu "T" oder ein "T" zu "C" geändert. Du kannst mal schauen was dieser ausdruck ausgibt:</p>
            <pre>
seq1 = c("A", "G", "C", "T", "A", "C", "G", "T")
seq2 = c("G", "G", "C", "T", "T", "C", "T", "A")    

print((seq1 == "A" & seq2 == "G"))
            </pre>
            <p>Wenn wir alle Conditions mit einen "oder (|)" verknüpfen können wir die gesamte Anzahl an Transitions bestimmen und das wäre deine nächste Task.</p>
            </div>

            <div class="page" data-page="2">
                <h1>Kimura-Dsitanz - Seite 2</h1>
                <p>Lösung:</p>
                <pre>
kimura_distance = function(seq1, seq2) {
    is_transition = (seq1 == "A" & seq2 == "G") | (seq1 == "G" & seq2 == "A") | (seq1 == "C" & seq2 == "T") | (seq1 == "T" & seq2 == "C") 
}
                </pre>
                <p>Das Ergebnis ist aber noch nicht fertig wir müssen es in eine Zahl umwandlen, das geht mit <code>sum()</code> und dann wollen wir damit noch P bestimmen, also den Anteil den die Transitions an der gesamten Länge der Sequenz annehmen, die Berechnung kriegst du easy mit <code>length()</code> hin.</p>
            </div>

            <div class="page" data-page="3">
                <h1>Kimura-Distanz - Seite 3</h1>
                <p>Lösung:</p>
                <pre>
kimura_distance = function(seq1, seq2) {
    is_transition = (seq1 == "A" & seq2 == "G") | (seq1 == "G" & seq2 == "A") | (seq1 == "C" & seq2 == "T") | (seq1 == "T" & seq2 == "C")
    
    P = sum(is_transition) / length(seq1)
}
                </pre>
                <p>Jetzt müssen wir noch Q bestimmen, dafür brauchen wir die Anzahl an Transversionen. Das können wir uns auch logisch bauen. Wir brauchen Alle Positionen in denen seq1 und seq2 unterschiedlich sind und können das mit einen "und (&)" mit der negation von unseren transitions Vektor koppeln. Das wäre deine nächste Task.</p>
            </div>

            <div class="page" data-page="4">
                <h1>Kimura-Distanz - Seite 4</h1>
                <p>Lösung:</p>
                <pre>
kimura_distance = function(seq1, seq2) {
    is_transition = (seq1 == "A" & seq2 == "G") | (seq1 == "G" & seq2 == "A") | (seq1 == "C" & seq2 == "T") | (seq1 == "T" & seq2 == "C")
    is_transversion = (seq1 != seq2) & !is_transition
    
    P = sum(is_transition) / length(seq1)
    Q = sum(is_transversion) / length(seq1)
    
}
                </pre>
                <p>Sooooo, als nächstes kannst du die Formel aufschreiben, da wir jetzt das P und Q haben: d = -(1/2) ln[(1-2P-Q)*sqrt(1-2Q)]</p>
            </div>

            <div class="page" data-page="5">
                <h1>Kimura-Distanz - Seite 5</h1>
                <p>Lösung:</p>
                <pre>
kimura_distance = function(seq1, seq2) {
    is_transition = (seq1 == "A" & seq2 == "G") | (seq1 == "G" & seq2 == "A") | (seq1 == "C" & seq2 == "T") | (seq1 == "T" & seq2 == "C")
    is_transversion = (seq1 != seq2) & !is_transition
    
    P = sum(is_transition) / length(seq1)
    Q = sum(is_transversion) / length(seq1)
    d = -0.5 * log(1 - 2 * P - Q) - 0.25 * log(1 - 2 * Q)
    
    return(d)
}
                </pre>
                <p>Unnnnnnd das wars schon wieder, heute hab ich dir mal so ein bisschen gezeigt, wie man logische Vektoren in Verbindung mit <code>sum()</code> usen kann, das Thema ausm skript hat perfekt gepasst. Ist auf den ersten Blick erstmal umständlich, aber sobald man die "und" bzw. "oder" Logik verstanden hat ist es easy, okeee, dann tschauuu :]</p>
                </div>


            <div class="navigation">
                <button class="nav-button" id="prevButton">Zurück</button>
                <button class="nav-button" id="nextButton">Weiter</button>
                <a href="../index.html" class="nav-button">Zum Kalender</a>
            </div>
        </div>

        <script>
            function createSnowflakes() {
                const snowContainer = document.getElementById('snowContainer');
                for (let i = 0; i < 100; i++) {
                    const snowflake = document.createElement('div');
                    snowflake.classList.add('snowflake');
                    snowflake.style.left = Math.random() * 100 + 'vw';
                    snowflake.style.width = Math.random() * 3 + 1 + 'px';
                    snowflake.style.height = snowflake.style.width;
                    snowflake.style.animationDuration = (Math.random() * 10 + 5) + 's';
                    snowflake.style.animationDelay = Math.random() * -10 + 's';
                    snowContainer.appendChild(snowflake);
                }
            }

            createSnowflakes();

            const pages = document.querySelectorAll('.page');
            const prevButton = document.getElementById('prevButton');
            const nextButton = document.getElementById('nextButton');
            let currentPage = 1;

            function updateButtons() {
                prevButton.disabled = currentPage === 1;
                nextButton.disabled = currentPage === pages.length;
            }

            function showPage(pageNumber) {
                pages.forEach(page => page.classList.remove('active'));
                document.querySelector(`[data-page="${pageNumber}"]`).classList.add('active');
                currentPage = pageNumber;
                updateButtons();
            }

            prevButton.addEventListener('click', () => {
                if (currentPage > 1) {
                    showPage(currentPage - 1);
                }
            });

            nextButton.addEventListener('click', () => {
                if (currentPage < pages.length) {
                    showPage(currentPage + 1);
                }
            });

            updateButtons();
        </script>
    </body>
</html>
