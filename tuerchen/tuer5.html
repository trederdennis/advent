<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Adventskalender - Tür</title>
        <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
    
            body {
                background: url('background.jpeg');
                background-size: cover;
                background-position: center center;
                background-repeat: no-repeat;
                background-attachment: fixed; /* Wichtig für Responsiveness */
                font-family: 'Mountains of Christmas', cursive;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                padding: 20px;
                color: #ffffff;
                overflow-x: hidden;
            }
    
            .snow {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                pointer-events: none;
                z-index: 1;
            }
    
            .snowflake {
                position: absolute;
                background: white;
                border-radius: 50%;
                opacity: 0.8;
                animation: fall linear infinite;
            }
    
            @keyframes fall {
                to {
                    transform: translateY(100vh) rotate(720deg);
                }
            }
    
            .content {
                position: relative;
                z-index: 2;
                text-align: center;
                max-width: 800px;
                padding: 20px;
                background: rgba(0, 0, 0, 0.656);
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            }
    
            h1 {
                color: #E0E7FF;
                font-size: 2em;
                font-weight: 700;
                text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
                margin-bottom: 20px;
            }
    
            p {
                color: #c9ddf7;
                font-size: 1.2em;
                font-weight: 400;
                margin-bottom: 10px;
                text-align: left;
            }
    
            ul {
                color: #c9ddf7;
                font-size: 1em;
                font-weight: 400;
                margin-left: 40px;
                margin-bottom: 20px;
                text-align: left;
            }
    
            li {
                margin-bottom: 10px;
            }
    
            .navigation {
                display: flex;
                gap: 20px;
                justify-content: center;
                margin-top: 20px;
            }
    
            .nav-button {
                padding: 10px 20px;
                font-size: 1.2em;
                color: #E0E7FF;
                text-decoration: none;
                background: rgba(255, 255, 255, 0.2);
                border: none;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
            }
    
            .nav-button:hover {
                background: rgba(255, 255, 255, 0.5);
                transform: scale(1.05);
            }
    
            .nav-button:disabled {
                opacity: 0.5;
                cursor: not-allowed;
                transform: none;
            }
    
            .page {
                display: none;
            }
    
            .page.active {
                display: block;
            }
        </style>
<body>
    <div class="snow" id="snowContainer"></div>
    <div class="content">
        <div class="page active" data-page="1">
            <h1>Türchen 5: Entropie</h1>
            <p>Hellooo, in dem heutigen Türchen geht es um die Entropie. Als Basis werden wir, den Code aus Tag 4 nehmen:
            </p>
            <pre>
# PFM Funktion 
count_frequencies = function(position_matrix) {
    basen = c("A", "C", "G", "T")
    frequency_matrix = matrix(0, nrow = ncol(position_matrix), ncol = length(basen))
    
    for (pos in 1:ncol(position_matrix)) {
        for (i in 1:length(basen)) {
            frequency_matrix[pos, i] = sum(position_matrix[, pos] == basen[i])
        }
    }
    
    colnames(frequency_matrix) = basen
    
    return(frequency_matrix)
}

# Sequezen
sequences = c("ATA", "CTG", "GTG", "TTA")

# PFM Matrix erstellen
split_sequences = strsplit(sequences, "")
anzahl_sequenzen = length(sequences)
position_matrix = matrix(unlist(split_sequences), nrow = anzahl_sequenzen, byrow = TRUE)
frequency_matrix = count_frequencies(position_matrix)
print(frequency_matrix)
            </pre>

            <p>Aus den PFM können wir leicht eine "Positionsspezifische Wahrscheinlichkeitsmatrix (PWM)" erstellen, die wir dann in Kombi mit der Formel zur Entropie Berechnung benutzen können. Du kannst dir vllt. zuerst mal anschauen, was genau die (PWM) ist und wie wir Sie aus der (PFM) erstellen können. </p>
            <p>Tipps:</p>
            <ul>
                <li>wir können es etwas lang machen, mit for schleifen oder wir nutzen aus das man "matrix-objekte" einfach teilen kann</li>
            </ul>
            <p>juup, dann geht es auf der nächsten page los :]</p>
        </div>

        <div class="page" data-page="2">
            <h1>Entropie - Seite 2</h1>
            <p>Lösung:</p>
            <pre>
# Kurze Möglichkeit -> Matrix ausnutzen               
n_sequences = nrow(position_matrix)

probability_matrix = frequency_matrix / n_sequences
print(probability_matrix)

# Lange Möglichkeit mit for schleifen
n_sequences <- nrow(position_matrix)
probability_matrix <- matrix(0, nrow = nrow(frequency_matrix), ncol = ncol(frequency_matrix))

for (i in 1:nrow(frequency_matrix)) {
  for (j in 1:ncol(frequency_matrix)) {
    probability_matrix[i, j] <- frequency_matrix[i, j] / n_sequences
  }
}

print(probability_matrix)
            </pre>
            <p>Okeyy, jetzt können wir schon anfangen eine Funktion zu schreiben, die die Entropie für jede Position berechnet. Dafür hätte ich wieder ein Frame für dich:</p>
            <pre>
calculate_entropy = function(probability_matrix) {
    n_positions = ?
    entropies = ?
    
    for (pos in 1:?) {
        probs = ?
        
        entropies[pos] = -sum(probs[probs > 0] * log2(probs[probs > 0]))
    }
    
    return(entropies)
}
            </pre>
            <p>Zuerst brauchen wir die Anzahl an Positionen und ein Objekt wo wir die berechneten Entropien abspeichern (die ersten beiden (?)). Du kannst dir wieder überlegen wie wir diese bekommen und passend findest du dann bestimmt auch schon raus wie oft unsere for-schleife laufen muss.</p>
            <p>Tipps:</p>
            <ul>
                <li>numeric() und nrow() Befehl benutzen</li>
            </ul>
        </div>

        <style>
            pre {
                background-color: #d8d8d814;
                border: 1px solid #ddd;
                border-radius: 4px;
                padding: 10px;
                font-family: 'Courier New', monospace;
                white-space: pre-wrap;
                word-wrap: break-word;
                text-align: left;
                margin: 10px 0;
                font-size: 0.8em;
                line-height: 1.4;
            }
        </style>
        
        <div class="page" data-page="3">
            <h1>Entropie - Seite 3</h1>
            <p>Lösung:</p>
            <pre>
calculate_entropy = function(probability_matrix) {
    n_positions = nrow(probability_matrix)
    entropies = numeric(n_positions)
    
    for (pos in 1:n_positions) {
        probs = ?
        
        entropies[pos] = -sum(probs[probs > 0] * log2(probs[probs > 0]))
    }
    
    return(entropies)
}
            </pre>
        <p>supperr,  dir ist wahrscheinlich schon aufgefallen, das ich die Formel für die Entropie Berechnung schon eingesetzt habe. Also probability mal den Logarithmus der probability und das summiert für jede Base die in der Position auftaucht. Ich hab das mal einfach schon vorgegeben, da man beachten muss das log(0) immer -Inf zurückgibt und so unsere Ergebnisse bissl kaputt macht. Wir haben somit extra die Condition (probs>0) eingebaut. Aber jaa, das ist so ein Ding an den man sich ewig dranhängen kann, wenn man nicht weiß was man falsch gemacht hat. Alsoooo, wieder zurück. Die Funktion ist ja trotzdem noch nicht fertig. Wir müssen überhaupt noch verstehen was "probs" ist. Kleiner Spoiler immer nur ein Teil unserer probability_matrix. Die Frage ist nur was genau, entweder die Rows oder Columns. Entsprechend usen wir bei der Berechnung danach immer nur die Einträge die größer null sind probs[probs>0]. Aber ja, das kriegst du bestimmt hin :)</p>
        <p>Tipps:</p>
        <ul>
            <li>benutze unsere probabiliyt_matrix und das "pos"</li>
        </ul>
        </div>

        <div class="page" data-page="4">
            <h1>Entropie - Seite 4</h1>
            <p>Lösung:</p>
            <pre>
calculate_entropy = function(probability_matrix) {
    n_positions = nrow(probability_matrix)
    entropies = numeric(n_positions)
    
    for (pos in 1:n_positions) {
        probs = probability_matrix[pos, ]
        
        entropies[pos] = -sum(probs[probs > 0] * log2(probs[probs > 0]))
    }
    
    return(entropies)
}
    
    # Funktion Testen
    entropies = calculate_entropy(probability_matrix)
    print("Entropien pro Position:")
    print(entropies)
            </pre>
            <p>Wieder was geschafft, i guess, hoffentlich war es nicht dumm erklärt und ich konnte dir iwie helfen und jup tschauuu :]</p>
        </div>
    

        <div class="navigation">
            <button class="nav-button" id="prevButton">Zurück</button>
            <button class="nav-button" id="nextButton">Weiter</button>
            <a href="../index.html" class="nav-button">Zum Kalender</a>
        </div>
    </div>


    <script>
        function optimizeBackgroundImage() {
        const body = document.body;
        const img = new Image();
        img.src = 'tuerchen/background.jpeg';
        
        img.onload = function() {
            const aspectRatio = img.width / img.height;
            const windowAspectRatio = window.innerWidth / window.innerHeight;
            
            if (aspectRatio > windowAspectRatio) {
                // Wenn das Bild breiter ist als der Bildschirm
                body.style.backgroundSize = 'auto 100%';
            } else {
                // Wenn das Bild höher ist als der Bildschirm
                body.style.backgroundSize = '100% auto';
            }
        };

        // Aktualisiere bei Größenänderung des Fensters
        window.addEventListener('resize', optimizeBackgroundImage);
    }
        function createSnowflakes() {
            const snowContainer = document.getElementById('snowContainer');
            for (let i = 0; i < 100; i++) {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.style.left = Math.random() * 100 + 'vw';
                snowflake.style.width = Math.random() * 3 + 1 + 'px';
                snowflake.style.height = snowflake.style.width;
                snowflake.style.animationDuration = (Math.random() * 10 + 5) + 's';
                snowflake.style.animationDelay = Math.random() * -10 + 's';
                snowContainer.appendChild(snowflake);
            }
        }

        createSnowflakes();

        // Navigation Logic
        const pages = document.querySelectorAll('.page');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        let currentPage = 1;

        function updateButtons() {
            prevButton.disabled = currentPage === 1;
            nextButton.disabled = currentPage === pages.length;
        }

        function showPage(pageNumber) {
            pages.forEach(page => page.classList.remove('active'));
            document.querySelector(`[data-page="${pageNumber}"]`).classList.add('active');
            currentPage = pageNumber;
            updateButtons();
        }

        prevButton.addEventListener('click', () => {
            if (currentPage > 1) {
                showPage(currentPage - 1);
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentPage < pages.length) {
                showPage(currentPage + 1);
            }
        });

        updateButtons();
    </script>
</body>
</html>
