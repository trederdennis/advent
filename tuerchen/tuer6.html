<!DOCTYPE html>
<html lang="de">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Adventskalender - Tür</title>
        <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;700&display=swap" rel="stylesheet">
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
    
            body {
                background: url('background.jpeg');
                background-size: cover;
                background-position: center center;
                background-repeat: no-repeat;
                background-attachment: fixed; /* Wichtig für Responsiveness */
                font-family: 'Mountains of Christmas', cursive;
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                padding: 20px;
                color: #ffffff;
                overflow-x: hidden;
            }
    
            .snow {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                pointer-events: none;
                z-index: 1;
            }
    
            .snowflake {
                position: absolute;
                background: white;
                border-radius: 50%;
                opacity: 0.8;
                animation: fall linear infinite;
            }
    
            @keyframes fall {
                to {
                    transform: translateY(100vh) rotate(720deg);
                }
            }
    
            .content {
                position: relative;
                z-index: 2;
                text-align: center;
                max-width: 800px;
                padding: 20px;
                background: rgba(0, 0, 0, 0.656);
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            }
    
            h1 {
                color: #E0E7FF;
                font-size: 2em;
                font-weight: 700;
                text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
                margin-bottom: 20px;
            }
    
            p {
                color: #c9ddf7;
                font-size: 1.2em;
                font-weight: 400;
                margin-bottom: 10px;
                text-align: left;
            }
    
            ul {
                color: #c9ddf7;
                font-size: 1em;
                font-weight: 400;
                margin-left: 40px;
                margin-bottom: 20px;
                text-align: left;
            }
    
            li {
                margin-bottom: 10px;
            }
    
            .navigation {
                display: flex;
                gap: 20px;
                justify-content: center;
                margin-top: 20px;
            }
    
            .nav-button {
                padding: 10px 20px;
                font-size: 1.2em;
                color: #E0E7FF;
                text-decoration: none;
                background: rgba(255, 255, 255, 0.2);
                border: none;
                border-radius: 10px;
                cursor: pointer;
                transition: all 0.3s ease;
            }
    
            .nav-button:hover {
                background: rgba(255, 255, 255, 0.5);
                transform: scale(1.05);
            }
    
            .nav-button:disabled {
                opacity: 0.5;
                cursor: not-allowed;
                transform: none;
            }
    
            .page {
                display: none;
            }
    
            .page.active {
                display: block;
            }
        </style>
<body>
    <div class="snow" id="snowContainer"></div>
    <div class="content">
        <div class="page active" data-page="1">
            <h1>Türchen 6: Kullback-Leibler-Divergenz</h1>
            <p>Hejj, wir schauen uns heute die Kullback-Leibler-Divergenz an. Das heißt wir können wieder Code benutzen den wir geschrieben haben. Alsooo, die "PWM":</p>
            <pre>
# PFM Funktion 
count_frequencies = function(position_matrix) {
    basen = c("A", "C", "G", "T")
    frequency_matrix = matrix(0, nrow = ncol(position_matrix), ncol = length(basen))
    
    for (pos in 1:ncol(position_matrix)) {
        for (i in 1:length(basen)) {
            frequency_matrix[pos, i] = sum(position_matrix[, pos] == basen[i])
        }
    }
    
    colnames(frequency_matrix) = basen
    
    return(frequency_matrix)
}

# Sequezen
sequences = c("ATA", "CTG", "GTG", "TTA")

# PFM Matrix erstellen
split_sequences = strsplit(sequences, "")
anzahl_sequenzen = length(sequences)
position_matrix = matrix(unlist(split_sequences), nrow = anzahl_sequenzen, byrow = TRUE)
frequency_matrix = count_frequencies(position_matrix)
print(frequency_matrix)

# PWM
n_sequences = nrow(position_matrix)
probability_matrix = frequency_matrix / n_sequences
print(probability_matrix)
            </pre>

            <p>Für die Berechnung brauchen wir eine Hintergrundwahrscheinlichkeit q(x). Wir gehen mal davon aus das alle Basen gleichverteilt sind, entsprechend kannst du selbst schonmal einen passenden Vektor/Liste definieren und auf der nächsten page gehts dann los :]
            </p>
        </div>

        <div class="page" data-page="2">
            <h1>DKL - Seite 2</h1>
            <p>Lösung:</p>
            <pre>
background_probabilities = c(0.25, 0.25, 0.25, 0.25)
            </pre>
            <p>Soooo, jetzt können wir schon anfangen die Funktion zu schreiben. Wenn du dir die Formel anschaust sollte dir auffallen das sie super ähnlich zu der Entropie ist, wir müssen nur ein "geteilt" einbauen und der Funktion unsere Hintergrundwahrscheinlichkeit übergeben. Hier ist nochmal die Entropie-Funktion:</p>
            <pre>
calculate_entropy = function(probability_matrix) {
    n_positions = nrow(probability_matrix)
    entropies = numeric(n_positions)
    
    for (pos in 1:n_positions) {
        probs = probability_matrix[pos, ]
        entropies[pos] = -sum(probs[probs > 0] * log2(probs[probs > 0]))
    }
    
    return(entropies)
    }
            </pre>
            <p>Ich denk mal du kriegst es hin die Funktion so anzupassen das sie die KL-Divergenz berechnen kann.</p>
            <p>Tipps:</p>
            <ul>
                <li>du musst auf die background_probabilitys ähnlich wie auf die probs zugreifen.</li>
            </ul>
        </div>

        <style>
            pre {
                background-color: #d8d8d814;
                border: 1px solid #ddd;
                border-radius: 4px;
                padding: 10px;
                font-family: 'Courier New', monospace;
                white-space: pre-wrap;
                word-wrap: break-word;
                text-align: left;
                margin: 10px 0;
                font-size: 0.8em;
                line-height: 1.4;
            }
        </style>
        
        <div class="page" data-page="3">
            <h1>DKL - Seite 3</h1>
            <p>Lösung:</p>
            <pre>
kl_divergence = function(probability_matrix, background_probabilities) {
    n_positions = nrow(probability_matrix)
    kl_divergences = numeric(n_positions)
    
    for (pos in 1:n_positions) {
        probs = probability_matrix[pos, ] 
        kl_divergences[pos] = sum(probs[probs > 0] * log2(probs[probs > 0] / background_probabilities[probs > 0]))
    }
    
    return(kl_divergences)
    }

# KL-Divergenz-Berechnung testen
kl_values = kl_divergence(probability_matrix, background_probabilities)
print("KL-Divergenz pro Position:")
print(kl_values)
            </pre>
        <p>Das wars schon, wir nutzen hier wieder Vektor Operationen aus. Wenn du es im Detail besser verstehen willst, kannst du immer print statements in die Schleifen packen die die einzelnen Variablen ausgeben. Ein Tipp wäre noch ein "break" dahinter zu packen, dann läuft die Schleife nur bis das break auftaucht und so wird dein Output nicht so zu gespammt. Aber jaaa, in Vektor-Operationen muss man sich ein bisschen reinwuseln bis man es genau versteht. Aber vllt. ist das ein gutes Beispiel um es zu verstehen. oköööö, dann tschauui :)</p>
        </div>

    

        <div class="navigation">
            <button class="nav-button" id="prevButton">Zurück</button>
            <button class="nav-button" id="nextButton">Weiter</button>
            <a href="../index.html" class="nav-button">Zum Kalender</a>
        </div>
    </div>


    <script>
        function optimizeBackgroundImage() {
        const body = document.body;
        const img = new Image();
        img.src = 'tuerchen/background.jpeg';
        
        img.onload = function() {
            const aspectRatio = img.width / img.height;
            const windowAspectRatio = window.innerWidth / window.innerHeight;
            
            if (aspectRatio > windowAspectRatio) {
                // Wenn das Bild breiter ist als der Bildschirm
                body.style.backgroundSize = 'auto 100%';
            } else {
                // Wenn das Bild höher ist als der Bildschirm
                body.style.backgroundSize = '100% auto';
            }
        };

        // Aktualisiere bei Größenänderung des Fensters
        window.addEventListener('resize', optimizeBackgroundImage);
    }
        function createSnowflakes() {
            const snowContainer = document.getElementById('snowContainer');
            for (let i = 0; i < 100; i++) {
                const snowflake = document.createElement('div');
                snowflake.classList.add('snowflake');
                snowflake.style.left = Math.random() * 100 + 'vw';
                snowflake.style.width = Math.random() * 3 + 1 + 'px';
                snowflake.style.height = snowflake.style.width;
                snowflake.style.animationDuration = (Math.random() * 10 + 5) + 's';
                snowflake.style.animationDelay = Math.random() * -10 + 's';
                snowContainer.appendChild(snowflake);
            }
        }

        createSnowflakes();

        // Navigation Logic
        const pages = document.querySelectorAll('.page');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        let currentPage = 1;

        function updateButtons() {
            prevButton.disabled = currentPage === 1;
            nextButton.disabled = currentPage === pages.length;
        }

        function showPage(pageNumber) {
            pages.forEach(page => page.classList.remove('active'));
            document.querySelector(`[data-page="${pageNumber}"]`).classList.add('active');
            currentPage = pageNumber;
            updateButtons();
        }

        prevButton.addEventListener('click', () => {
            if (currentPage > 1) {
                showPage(currentPage - 1);
            }
        });

        nextButton.addEventListener('click', () => {
            if (currentPage < pages.length) {
                showPage(currentPage + 1);
            }
        });

        updateButtons();
    </script>
</body>
</html>
